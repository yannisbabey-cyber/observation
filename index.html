<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Les techniques d’observation de la réalité</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#f3f4f6;
      --ink:#0f172a;
      --muted:#475569;
      --card:#ffffff;
      --line:#e5e7eb;
      --shadow: 0 8px 24px rgba(15,23,42,.08);
      --shadow2: 0 12px 36px rgba(15,23,42,.12);
      --radius: 18px;

      /* Pastels catégories */
      --cat-obs:#cfe8ff;
      --cat-inter:#ffd9e6;
      --cat-imm:#d7f7e8;
      --cat-parc:#fff3c4;
      --cat-exp:#ffd9c2;
      --cat-suivi:#e6ddff;
      --cat-inv:#dff4ff;
      --cat-lang:#e9ffe0;
      --cat-meta:#eaeaea;

      /* Attention */
      --warn-bg:#fff7ed;
      --warn-line:#fed7aa;
      --warn-ink:#9a3412;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:var(--bg);
    }

    header{
      background: linear-gradient(180deg, #111827, #0b1220);
      color:white;
      padding: 1.1rem 1rem 1rem;
      position: sticky;
      top:0;
      z-index: 50;
      box-shadow: 0 6px 20px rgba(0,0,0,.18);
    }
    .wrap{ max-width: 1200px; margin:0 auto; }

    .topbar{
      display:flex;
      gap:.8rem;
      align-items:flex-start;
      flex-wrap:wrap;
      justify-content:space-between;
    }

    h1{
      font-size: 1.1rem;
      margin:0;
      font-weight: 950;
      letter-spacing: .2px;
    }
    .subtitle{
      font-size: .85rem;
      color: rgba(255,255,255,.78);
      margin-top:.25rem;
      max-width: 78ch;
      line-height: 1.35;
    }
    .source{
      font-size: .82rem;
      color: rgba(255,255,255,.70);
      margin-top:.35rem;
      line-height: 1.35;
    }

    .searchRow{
      display:flex;
      gap:.5rem;
      align-items:center;
      flex: 1 1 520px;
      justify-content:flex-end;
    }
    .searchRow input{
      width: min(640px, 100%);
      padding: .75rem .9rem;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      outline:none;
      color: white;
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(6px);
    }
    .searchRow input::placeholder{ color: rgba(255,255,255,.65); }
    .pill{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.9);
      padding: .55rem .8rem;
      border-radius: 999px;
      cursor: pointer;
      font-size: .85rem;
      user-select:none;
    }

    .cats{
      display:flex;
      flex-wrap:wrap;
      gap:.5rem;
      margin-top:.8rem;
    }
    .catBtn{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.9);
      padding: .45rem .7rem;
      border-radius: 999px;
      cursor:pointer;
      font-size:.82rem;
      display:inline-flex;
      align-items:center;
      gap:.45rem;
      user-select:none;
    }
    .catDot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.35);
      display:inline-block;
    }
    .catBtn.active{
      background: rgba(255,255,255,.18);
      border-color: rgba(255,255,255,.28);
    }

    main{
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 1rem;
      margin-top: .75rem;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .searchRow{ justify-content:flex-start; }
    }
    @media (max-width: 620px){
      .grid{ grid-template-columns: 1fr; }
      .subtitle{ display:none; }
    }

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 250px;
    }
    .cardHeader{
      padding: .85rem .95rem .6rem;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:.8rem;
    }
    .exNo{
      font-size:.78rem;
      color: var(--muted);
      font-weight:900;
      letter-spacing:.2px;
    }
    .exTitle{
      margin:.15rem 0 0;
      font-size: 1.08rem;
      line-height:1.2;
      font-weight:950;
    }
    .badge{
      padding: .35rem .6rem;
      border-radius: 999px;
      font-size:.78rem;
      font-weight:950;
      color:#111827;
      border:1px solid rgba(15,23,42,.08);
      white-space:nowrap;
    }

    .iconWrap{
      width:100%;
      background: #fafafa;
      border-top:1px dashed rgba(15,23,42,.08);
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 1rem;
    }
    .iconWrap svg{
      width: 120px;
      height: 90px;
      stroke:#111827;
      fill:none;
      stroke-width:2.2;
      stroke-linecap:round;
      stroke-linejoin:round;
      opacity:.92;
    }

    .cardBody{
      padding: .85rem .95rem 1rem;
      display:flex;
      flex-direction:column;
      gap:.7rem;
      flex:1;
    }
    .miniDesc{
      color: var(--muted);
      font-size:.92rem;
      line-height:1.38;
      margin:0;
      display:-webkit-box;
      -webkit-line-clamp:3;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .actions{
      display:flex;
      gap:.6rem;
      margin-top:auto;
      flex-wrap:wrap;
    }
    .btn{
      border:1px solid var(--line);
      background:white;
      border-radius: 999px;
      padding: .55rem .75rem;
      cursor:pointer;
      font-weight:950;
      font-size:.85rem;
      color:#111827;
      display:inline-flex;
      align-items:center;
      gap:.45rem;
    }
    .btnPrimary{
      background:#111827;
      color:white;
      border-color:#111827;
    }

    /* Modal */
    .modalOverlay{
      position:fixed;
      inset:0;
      background: rgba(2,6,23,.62);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 1rem;
      z-index:100;
    }
    .modal{
      width: min(980px, 100%);
      max-height: min(86vh, 880px);
      overflow:auto;
      background:white;
      border-radius: 22px;
      box-shadow: var(--shadow2);
      border: 1px solid rgba(255,255,255,.22);
    }
    .modalTop{
      padding: .9rem 1rem;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:1rem;
      position:sticky;
      top:0;
      background:white;
      z-index:2;
    }
    .modalTop h2{
      margin:0;
      font-size: 1.15rem;
      font-weight: 950;
      line-height:1.2;
    }
    .modalTop .meta{
      margin-top:.2rem;
      color: var(--muted);
      font-size:.9rem;
      font-weight:900;
    }
    .closeBtn{
      border:1px solid var(--line);
      background:white;
      border-radius: 999px;
      padding:.45rem .7rem;
      cursor:pointer;
      font-weight:950;
    }
    .modalBody{
      padding: 1rem;
      display:grid;
      grid-template-columns: 1fr;
      gap: .9rem;
    }

    details{
      border: 1px solid var(--line);
      border-radius: 18px;
      background:#fbfbfd;
      padding: .65rem .8rem;
    }
    summary{
      cursor:pointer;
      font-weight:950;
      font-size:.95rem;
      list-style:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.6rem;
    }
    summary::-webkit-details-marker{ display:none; }
    .chev{
      width: 10px; height:10px;
      border-right: 2px solid #111827;
      border-bottom: 2px solid #111827;
      transform: rotate(45deg);
      opacity:.7;
      transition: transform .12s ease;
    }
    details[open] .chev{ transform: rotate(225deg); }

    .block{
      margin-top:.55rem;
      color: var(--ink);
      font-size:.95rem;
      line-height:1.45;
      font-weight: 720;
    }
    .muted{ color: var(--muted); font-weight:850; }

    .h3{
      margin:.7rem 0 .25rem;
      font-weight: 950;
      font-size:.95rem;
      letter-spacing:.1px;
    }
    .list{
      margin:.35rem 0 0 1.15rem;
      padding:0;
      line-height: 1.45;
      font-weight: 720;
    }
    .list li{ margin: .25rem 0; }

    .kv{
      display:grid;
      grid-template-columns: 170px 1fr;
      gap:.45rem .9rem;
      align-items:start;
      margin-top:.55rem;
      font-size:.95rem;
      line-height:1.45;
    }
    @media (max-width: 620px){
      .kv{ grid-template-columns: 1fr; }
    }
    .k{
      color: var(--muted);
      font-weight: 950;
      text-transform: uppercase;
      letter-spacing:.35px;
      font-size:.78rem;
    }
    .v{
      color: var(--ink);
      font-weight: 750;
    }

    .warn{
      display:flex;
      gap:.6rem;
      align-items:flex-start;
      padding:.75rem .8rem;
      border:1px solid var(--warn-line);
      background: var(--warn-bg);
      border-radius: 18px;
      color: var(--warn-ink);
      font-size:.95rem;
      line-height:1.4;
      font-weight:850;
      margin-top:.55rem;
    }
    .warnIcon{
      width: 26px; height: 26px; flex:0 0 26px;
      margin-top: .05rem;
    }
    .warnIcon svg{
      width: 26px; height: 26px;
      stroke: var(--warn-ink);
      fill:none;
      stroke-width:2.2;
      stroke-linecap:round;
      stroke-linejoin:round;
    }

    mark{
      background: #fde68a;
      padding: 0 .15em;
      border-radius: .25em;
    }

    .empty{
      margin: 1.1rem 0;
      padding: 1rem;
      border: 1px dashed rgba(15,23,42,.18);
      border-radius: 18px;
      background: rgba(255,255,255,.65);
      color: var(--muted);
      font-weight: 900;
    }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <div class="topbar">
      <div>
        <h1>Les techniques d’observation de la réalité</h1>
        <div class="subtitle">
          Tuiles simples → clique pour ouvrir : <b>précisions</b>, <b>exemple</b>, <b>protocole très détaillé</b>, <b>points d’attention</b>.
        </div>
        <div class="source">
          Source : <b>Exercices d’observation</b>, Nicolas Nova, éditions Carnets parallèles / La vie des choses.
        </div>
      </div>

      <div class="searchRow">
        <input id="search" type="search" placeholder="Rechercher (titre, rôles, étapes, mots-clés…)" />
        <button class="pill" id="clearBtn" title="Effacer la recherche">✕ Effacer</button>
      </div>
    </div>

    <div class="cats" id="catMenu" aria-label="Catégories"></div>
  </div>
</header>

<main>
  <div class="wrap">
    <div id="count" class="empty" style="display:none;"></div>
    <section class="grid" id="grid" aria-label="Liste des exercices"></section>
    <div id="nores" class="empty" style="display:none;">Aucun résultat. Essaie un autre mot-clé ou change de catégorie.</div>
  </div>
</main>

<!-- Modal -->
<div class="modalOverlay" id="overlay" role="dialog" aria-modal="true" aria-label="Détails de l'exercice">
  <div class="modal">
    <div class="modalTop">
      <div>
        <h2 id="mTitle">Titre</h2>
        <div class="meta" id="mMeta">Meta</div>
      </div>
      <button class="closeBtn" id="closeBtn">Fermer</button>
    </div>

    <div class="modalBody">
      <details open>
        <summary>Précisions de l’observation <span class="chev" aria-hidden="true"></span></summary>
        <div class="block" id="mDesc"></div>
        <div class="block" style="margin-top:.65rem;">
          <span class="muted">Objectifs (“pour quoi”) :</span>
          <span id="mGoals"></span>
        </div>
      </details>

      <details>
        <summary>Exemple concret <span class="chev" aria-hidden="true"></span></summary>
        <div class="block" id="mExample"></div>
      </details>

      <details>
        <summary>Protocole détaillé (rôles + quoi observer + étapes) <span class="chev" aria-hidden="true"></span></summary>
        <div class="block" id="mProtocol"></div>
        <div class="kv" id="mProtoKV"></div>
      </details>

      <details>
        <summary>Points d’attention <span class="chev" aria-hidden="true"></span></summary>
        <div class="warn" id="mWarn"></div>
      </details>

      <details>
        <summary>Variantes & mots-clés <span class="chev" aria-hidden="true"></span></summary>
        <div class="block"><span class="muted">Variantes :</span> <span id="mVar"></span></div>
        <div class="block" style="margin-top:.6rem;"><span class="muted">Mots-clés :</span> <span id="mTags"></span></div>
      </details>
    </div>
  </div>
</div>

<script>
  /* =========================
     Catégories
     ========================= */
  const CATEGORIES = [
    { id:"all",    label:"Toutes",         dot:"#ffffff" },
    { id:"obs",    label:"Observer",       dotVar:"--cat-obs"   },
    { id:"inter",  label:"Interroger",     dotVar:"--cat-inter" },
    { id:"imm",    label:"S’immerger",     dotVar:"--cat-imm"   },
    { id:"parc",   label:"Parcours",       dotVar:"--cat-parc"  },
    { id:"exp",    label:"Expérimenter",   dotVar:"--cat-exp"   },
    { id:"suivi",  label:"Suivre/Veiller", dotVar:"--cat-suivi" },
    { id:"inv",    label:"Inventorier/Classer", dotVar:"--cat-inv" },
    { id:"lang",   label:"Langage",        dotVar:"--cat-lang"  },
    { id:"meta",   label:"Composer",       dotVar:"--cat-meta"  },
  ];

  function catBadge(catId){
    const label = CATEGORIES.find(x=>x.id===catId)?.label || "Catégorie";
    const bg = (catId==="obs") ? "var(--cat-obs)"
            : (catId==="inter") ? "var(--cat-inter)"
            : (catId==="imm") ? "var(--cat-imm)"
            : (catId==="parc") ? "var(--cat-parc)"
            : (catId==="exp") ? "var(--cat-exp)"
            : (catId==="suivi") ? "var(--cat-suivi)"
            : (catId==="inv") ? "var(--cat-inv)"
            : (catId==="lang") ? "var(--cat-lang)"
            : "var(--cat-meta)";
    return { label, bg };
  }

  /* =========================
     Icônes (SVG noir/blanc)
     ========================= */
  function iconSVG(name){
    const s = {
      eye: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M15 60c18-28 45-40 65-40s47 12 65 40c-18 28-45 40-65 40S33 88 15 60z"/>
          <circle cx="80" cy="60" r="16"/>
          <circle cx="86" cy="56" r="4"/>
        </svg>`,
      map: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M20 28l35-10 50 14 35-10v70l-35 10-50-14-35 10z"/>
          <path d="M55 18v70"/>
          <path d="M105 32v70"/>
          <path d="M30 54c10-8 18-8 28 0s18 8 28 0 18-8 28 0"/>
        </svg>`,
      sound: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M30 70V50"/>
          <path d="M45 78V42"/>
          <path d="M60 86V34"/>
          <path d="M75 78V42"/>
          <path d="M90 70V50"/>
          <path d="M110 52c10 10 10 26 0 36"/>
          <path d="M122 44c16 16 16 42 0 58"/>
        </svg>`,
      footprints: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M55 76c6-10 6-22 0-32-6-10-18-8-22 2-4 10 3 24 22 30z"/>
          <path d="M90 92c6-10 6-22 0-32-6-10-18-8-22 2-4 10 3 24 22 30z"/>
          <circle cx="36" cy="40" r="6"/>
          <circle cx="44" cy="34" r="5"/>
          <circle cx="54" cy="32" r="4"/>
          <circle cx="78" cy="56" r="6"/>
          <circle cx="86" cy="50" r="5"/>
          <circle cx="96" cy="48" r="4"/>
        </svg>`,
      chat: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M24 30h86a20 20 0 0 1 20 20v14a20 20 0 0 1-20 20H64l-24 18v-18H24a20 20 0 0 1-20-20V50a20 20 0 0 1 20-20z"/>
          <path d="M40 56h60"/>
          <path d="M40 70h40"/>
        </svg>`,
      diagram: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <rect x="18" y="18" width="46" height="26" rx="6"/>
          <rect x="96" y="18" width="46" height="26" rx="6"/>
          <rect x="18" y="76" width="46" height="26" rx="6"/>
          <rect x="96" y="76" width="46" height="26" rx="6"/>
          <path d="M64 31h32"/>
          <path d="M41 44v32"/>
          <path d="M119 44v32"/>
          <path d="M64 89h32"/>
        </svg>`,
      list: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <rect x="28" y="22" width="104" height="76" rx="10"/>
          <path d="M44 42h72"/>
          <path d="M44 58h72"/>
          <path d="M44 74h72"/>
          <path d="M36 42h.01M36 58h.01M36 74h.01"/>
        </svg>`,
      compare: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <circle cx="55" cy="52" r="22"/>
          <circle cx="105" cy="68" r="22"/>
          <path d="M40 52h30"/>
          <path d="M90 68h30"/>
          <path d="M68 60l12 6"/>
        </svg>`,
      screen: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <rect x="20" y="18" width="120" height="72" rx="10"/>
          <path d="M60 96h40"/>
          <path d="M34 34h50"/>
          <path d="M34 48h70"/>
          <path d="M34 62h60"/>
        </svg>`,
      target: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <circle cx="80" cy="60" r="40"/>
          <circle cx="80" cy="60" r="26"/>
          <circle cx="80" cy="60" r="12"/>
          <path d="M80 20v12M80 88v12M40 60h12M108 60h12"/>
        </svg>`,
      hands: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M34 68c8 0 14-6 14-14V42c0-6 8-6 8 0v18"/>
          <path d="M56 60V38c0-6 8-6 8 0v24"/>
          <path d="M72 62V40c0-6 8-6 8 0v26"/>
          <path d="M88 68V46c0-6 8-6 8 0v22"/>
          <path d="M34 68c0 20 12 34 34 34h14c22 0 34-14 34-34"/>
        </svg>`,
      walk: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <circle cx="56" cy="30" r="10"/>
          <path d="M56 40l-10 24"/>
          <path d="M56 48l18 10"/>
          <path d="M46 64l-10 26"/>
          <path d="M74 58l10 28"/>
          <path d="M104 30c14 10 20 22 20 36s-8 26-20 36"/>
          <path d="M104 30c-8 6-12 14-12 24s4 18 12 24"/>
        </svg>`,
      warning: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M80 18l62 92H18z"/>
          <path d="M80 50v26"/>
          <path d="M80 88h.01"/>
        </svg>`,
      clock: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <circle cx="80" cy="60" r="42"/>
          <path d="M80 60V38"/>
          <path d="M80 60l20 12"/>
          <path d="M52 18l-10 12M108 18l10 12"/>
        </svg>`,
      folder: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M22 40h50l10 10h56v54H22z"/>
          <path d="M22 40v-8c0-6 4-10 10-10h32l10 10h64c6 0 10 4 10 10v8"/>
          <path d="M34 64h92"/>
          <path d="M34 78h72"/>
        </svg>`,
      box: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M30 40l50-20 50 20-50 20z"/>
          <path d="M30 40v50l50 20 50-20V40"/>
          <path d="M80 60v50"/>
        </svg>`,
      abc: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <path d="M36 96V26h56l16 16v54z"/>
          <path d="M92 26v16h16"/>
          <path d="M52 62l8-18 8 18"/>
          <path d="M54 58h12"/>
          <path d="M78 62V44h10c6 0 8 3 8 7s-2 7-8 7H78"/>
          <path d="M110 60c-4 3-8 4-12 2-6-3-6-13 0-16 4-2 8-1 12 2"/>
        </svg>`,
      tree: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <rect x="70" y="18" width="20" height="16" rx="4"/>
          <path d="M80 34v14"/>
          <rect x="30" y="48" width="26" height="16" rx="4"/>
          <rect x="67" y="48" width="26" height="16" rx="4"/>
          <rect x="104" y="48" width="26" height="16" rx="4"/>
          <path d="M80 48h-37"/>
          <path d="M80 48h37"/>
          <path d="M43 64v14M80 64v14M117 64v14"/>
          <rect x="18" y="78" width="26" height="16" rx="4"/>
          <rect x="48" y="78" width="26" height="16" rx="4"/>
          <rect x="67" y="78" width="26" height="16" rx="4"/>
          <rect x="86" y="78" width="26" height="16" rx="4"/>
          <rect x="116" y="78" width="26" height="16" rx="4"/>
        </svg>`,
      kit: `
        <svg viewBox="0 0 160 120" aria-hidden="true">
          <rect x="28" y="42" width="104" height="54" rx="12"/>
          <path d="M50 42v-10c0-8 6-14 14-14h32c8 0 14 6 14 14v10"/>
          <path d="M28 62h104"/>
          <path d="M60 74h40"/>
          <path d="M80 62v14"/>
        </svg>`
    };
    return s[name] || s.eye;
  }

  /* =========================
     Panneau attention (icône)
     ========================= */
  function warnIcon(){
    return `
      <div class="warnIcon" aria-hidden="true">
        <svg viewBox="0 0 24 24">
          <path d="M12 3l10 18H2z"/>
          <path d="M12 9v5"/>
          <path d="M12 17h.01"/>
        </svg>
      </div>
    `;
  }

  /* =========================
     Helpers: HTML safe + highlight
     ========================= */
  const escapeHTML = (s) => (s ?? "").replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));

  function highlight(text, q){
    const safe = escapeHTML(text);
    if(!q) return safe;
    const re = new RegExp(`(${q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, "ig");
    return safe.replace(re, "<mark>$1</mark>");
  }

  function bulletHTML(items, q){
    return `<ul class="list">` + items.map(x=>`<li>${highlight(x, q)}</li>`).join("") + `</ul>`;
  }

  function sectionHTML(title, items, q){
    return `<div class="h3">${escapeHTML(title)}</div>${bulletHTML(items, q)}`;
  }

  /* =========================
     Données — 19 exercices (protocoles détaillés)
     - protocol: { roles[], observe[], steps[], material[], outputs[] }
     - kv: { Qui, Quoi, Comment, Combien, Quand, Où, Pourquoi, PourQuoi }
     ========================= */
  const EX = [
    {
      id:1, title:"Arpentage minutieux", cat:"obs", icon:"eye",
      desc:"Délimite une micro-zone et observe sans intervenir. Tu décris les routines du lieu (positions, distances, trajectoires, micro-gestes) et son organisation matérielle. Objectif : produire une description solide (notes + croquis) avant toute interprétation.",
      example:"Arrêt de bus : positions (assis/debout), distances, zones d’abri, micro-déplacements à l’arrivée d’une personne, consultation des horaires, sorties/entrées, effets météo.",
      goals:"Décrire avant d’expliquer ; repérer des régularités ; produire une fiche de terrain réutilisable (notes factuelles + croquis).",
      attention:"Pas de visages reconnaissables ; rester discret ; séparer “fait” et “hypothèse”.",
      protocol:{
        roles:[
          "Observateur·rice 1 : note tout ce qu’il/elle voit (objets, personnes, mouvements, détails).",
          "Observateur·rice 2 : note tout ce qu’il/elle entend (sons proches/lointains, paroles, ambiances).",
          "Chronométreur·se / garant·e de la méthode (si groupe de 3) : gère le temps, rappelle la règle “factuel”.",
          "Scribe / mise en forme : transforme les notes en tableau + croquis + mini-synthèse.",
          "Si vous êtes seul·e : deux colonnes “VU / ENTENDU” + une colonne “HYPOTHÈSES (à part)”."
        ],
        observe:[
          "Entités : humains, animaux, plantes, objets, véhicules, infrastructures, panneaux/écrits.",
          "Événements : arrivées/départs, interactions, changements d’allure, regroupements, interruptions.",
          "Détails : gestes, rythmes, répétitions, anomalies, matières, couleurs, distances, orientations du regard.",
          "Règle d’or : décrire sans interpréter (pas “il est énervé”, mais “voix forte, gestes rapides”)."
        ],
        steps:[
          "Choisir et délimiter la zone (ex. 10×10 m) + repères stables (mur, arbre, poteau).",
          "Fixer un point d’observation (où tu te places) + noter l’heure et la météo.",
          "Observer 10 min sans écrire (calibrage : tu repères ce qui revient).",
          "Observer 20 min avec prise de notes (VU/ENTENDU) + horodatage approximatif.",
          "Faire un croquis : plan simple, positions, flèches de trajectoires, zones (attente/passage).",
          "Mise au propre : tableau “faits” + 5 constats (formulés prudemment) + 3 questions ouvertes."
        ],
        material:[
          "Carnet + stylo (ou notes sur smartphone en mode avion).",
          "Minuteur (téléphone) ; éventuellement planchette pour écrire debout.",
          "Option : photo de contexte (sans personnes identifiables) ou croquis uniquement."
        ],
        outputs:[
          "Un tableau VU/ENTENDU/HYPOTHÈSES (séparées).",
          "Un croquis légendé (implantation + flux).",
          "5 constats factuels + 3 questions pour une enquête suivante."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s) (toi / vous) ; acteurs observés anonymisés.",
        Quoi:"Routines, interactions, organisation spatiale, indices matériels.",
        Comment:"Observation cadrée + notes factuelles + croquis + mise au propre.",
        Combien:"30–45 min (terrain) + 15 min (mise au propre).",
        Quand:"Deux moments contrastés si possible.",
        Où:"Micro-zone clairement définie (repères).",
        Pourquoi:"Apprendre à décrire avant d’interpréter.",
        PourQuoi:"Fiche de terrain + croquis utilisables pour analyse/restitution."
      },
      variants:"Variante : observer un seul paramètre (sons / distances / flux) pendant 15 minutes.",
      tags:["observation","description","croquis","routines","flux"]
    },

    {
      id:2, title:"Carte sensible d’un lieu", cat:"obs", icon:"map",
      desc:"Observer un lieu à travers les sens (sons, odeurs, températures, lumière, textures) et produire une carte d’ambiances. Objectif : transformer une perception située en donnée partageable (zones + intensités + légende).",
      example:"Couloir d’école : zones bruyantes/calmes, odeur cantine, bousculades, points d’attente, variations selon récré/fin de cours.",
      goals:"Décrire l’espace vécu ; relier ambiances et usages ; comparer des perceptions entre élèves.",
      attention:"Indiquer le contexte (heure/affluence) ; ne pas réduire à “j’aime/j’aime pas” : décrire ce qui provoque l’impression.",
      protocol:{
        roles:[
          "Cartographe : dessine le plan simple (contours + repères).",
          "Capteur·rice sensoriel·le : note sons/odeurs/température/lumière.",
          "Chronométreur·se : garde le rythme (arrêts de 1 min par point).",
          "Si seul·e : tu alternes “mesure” (notes) et “mise en carte” (petits croquis)."
        ],
        observe:[
          "Sons : intensité, continuité/rupture, proximité/lointain, échos, silences.",
          "Odeurs : fortes/faibles, agréables/désagréables, ponctuelles/persistantes.",
          "Thermique : zones froides/chaudes, courants d’air, humidité.",
          "Visuel : lumière/ombre, couleurs dominantes, mouvements.",
          "Tactile : sols, parois, rugosité, obstacles."
        ],
        steps:[
          "Choisir le lieu + tracer un plan de base (à main levée) avec 5–8 repères.",
          "Faire un parcours lent avec 5–8 arrêts fixes (1 min/arrêt).",
          "À chaque arrêt : 3 notes (son/odeur/thermique) + 1 détail “surprenant”.",
          "Coder l’intensité (faible/moyen/fort) avec hachures ou symboles.",
          "Mettre en carte : zones + flèches + légende claire (icônes).",
          "Comparer en binômes : où êtes-vous d’accord ? où divergez-vous ? pourquoi ?"
        ],
        material:[
          "Feuille A4/A3 + crayon ; surligneurs (facultatif).",
          "Minuteur ; éventuellement boussole (orientation)."
        ],
        outputs:[
          "Une carte sensible légendée (zones + intensités).",
          "5 constats (liens entre ambiance et usage).",
          "1 paragraphe de comparaison si travail à plusieurs."
        ]
      },
      kv:{
        Qui:"Un·e ou plusieurs observateur·rices ; possibilité de comparer des groupes.",
        Quoi:"Ambiances sensorielles + repères spatiaux.",
        Comment:"Parcours + arrêts + codage d’intensité + mise en carte.",
        Combien:"25–45 min.",
        Quand:"Calme vs chargé si possible.",
        Où:"Lieu délimité (couloir, place, parc, hall).",
        Pourquoi:"Rendre visible l’expérience sensible d’un espace.",
        PourQuoi:"Carte partageable + analyse des ambiances."
      },
      variants:"Variante : refaire le même lieu à deux horaires différents et superposer les cartes.",
      tags:["carte","ambiances","sens","intensité","légende"]
    },

    {
      id:3, title:"Paysage sonore", cat:"obs", icon:"sound",
      desc:"Observer un lieu en se focalisant sur le son : sources, intensité, rythmes, distance, ruptures. Objectif : produire un profil sonore et repérer des marqueurs d’activité.",
      example:"Place : cloches, trafic, voix, pas, livraisons, oiseaux ; noter dominantes et moments de bascule.",
      goals:"Apprendre à isoler une dimension ; saisir rythmes/cycles ; enrichir la description d’un espace.",
      attention:"Pas d’enregistrement de conversations privées ; si audio : demander l’accord si voix reconnaissables.",
      protocol:{
        roles:[
          "Noteur·se : liste les sons + minute approximative.",
          "Cartographe : schéma “toi au centre, sources autour” (direction + distance).",
          "Si seul·e : tu fais 5 min liste, puis 5 min schéma, puis 5 min synthèse."
        ],
        observe:[
          "Sources : humains, machines, nature, annonces, signaux.",
          "Intensité : faible/moyen/fort ; continu/intermittent.",
          "Distance/direction : proche/loin ; gauche/droite/derrière.",
          "Rythmes : répétitions, pics, silences.",
          "Effets de lieu : échos, réverbération, obstacles."
        ],
        steps:[
          "Choisir un point fixe (s’asseoir/tenir sa position).",
          "1 min : silence total (se calibrer).",
          "10 min : liste horodatée des sons + intensité.",
          "5 min : schéma circulaire des sources (direction/distance).",
          "5 min : repérer 3 dominantes + 2 ruptures (ce qui a changé).",
          "Mise au propre : “profil sonore” + 5 phrases factuelles."
        ],
        material:[
          "Carnet + stylo ; minuteur.",
          "Option : enregistreur/phone (uniquement si éthique OK)."
        ],
        outputs:[
          "Liste des sons (avec intensité).",
          "Schéma direction/distance.",
          "Mini-analyse : dominantes, ruptures, hypothèses prudentes."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s) au point fixe.",
        Quoi:"Sons, rythmes, dominantes, ruptures.",
        Comment:"Liste + schéma + synthèse.",
        Combien:"20–30 min.",
        Quand:"Moment représentatif (option : jour/nuit).",
        Où:"Un point fixe dans le lieu.",
        Pourquoi:"Comprendre le lieu par ses signaux sonores.",
        PourQuoi:"Profil sonore utilisable dans un dossier d’observation."
      },
      variants:"Variante : faire “avant/après” un événement (arrivée bus, sortie de classe).",
      tags:["son","rythmes","dominantes","ruptures"]
    },

    {
      id:4, title:"Traces et indices", cat:"obs", icon:"footprints",
      desc:"Observer un lieu via ses traces : usure, affichages, détournements, réparations, déchets, marques. Objectif : reconstituer des usages probables à partir d’indices matériels, sans romancer.",
      example:"Escalier : marches polies, chewing-gums, ruban de réparation, affiches superposées, coin fumeur.",
      goals:"S’entraîner à l’inférence prudente ; distinguer trace/indice/hypothèse ; comprendre le social dans le matériel.",
      attention:"Ne pas “inventer” : d’abord décrire, puis formuler l’hypothèse explicitement (“peut-être…”).",
      protocol:{
        roles:[
          "Photographe/croquiste : capture les traces (photo sans personnes) ou dessine.",
          "Archiviste : tableau Trace / Où / Description / Hypothèse / Certitude.",
          "Si seul·e : tu alternes 2 minutes “collecte” / 2 minutes “tableau”."
        ],
        observe:[
          "Usure : surfaces polies, rayures, fissures, réparations.",
          "Dépôts : déchets, mégots, chewing-gums, autocollants.",
          "Écrits : affiches, tags, signalétique bricolée.",
          "Détournements : objets déplacés, usages inattendus.",
          "Localisation : toujours noter où (repère) et quand."
        ],
        steps:[
          "Choisir un périmètre (ex. 1 couloir / 1 escalier / 1 entrée).",
          "Faire un repérage rapide (2 min) pour voir où se concentrent les traces.",
          "Collecter 10–20 traces (photo ou croquis) + localisation précise.",
          "Remplir le tableau : description factuelle d’abord.",
          "Ajouter une hypothèse + un degré de certitude (faible/moyen/fort).",
          "Synthèse : 3 familles de traces + ce qu’elles suggèrent sur les usages."
        ],
        material:[
          "Carnet/tableau ; téléphone (photos) ou crayon.",
          "Option : règle pour mesurer (taille d’une trace)."
        ],
        outputs:[
          "Inventaire (10–20 traces) + tableau complet.",
          "3 familles de traces + 5 hypothèses prudentes.",
          "1 question de suivi (que faudrait-il observer pour vérifier ?)"
        ]
      },
      kv:{
        Qui:"Observateur·rice ; éventuellement binôme photo/tableau.",
        Quoi:"Traces matérielles + localisation + hypothèses prudentes.",
        Comment:"Collecte + tableau + typologie.",
        Combien:"30–50 min.",
        Quand:"Après un pic d’activité (souvent riche).",
        Où:"Périmètre court et clair.",
        Pourquoi:"Lire les usages à partir d’indices.",
        PourQuoi:"Inventaire + typologie pour discussion/analyse."
      },
      variants:"Variante : ne prendre que les traces “détournements / bricolages”.",
      tags:["indices","usure","détournement","tableau","typologie"]
    },

    {
      id:5, title:"Mini-entretiens (questions naïves)", cat:"inter", icon:"chat",
      desc:"Interroger 2 à 5 personnes sur une pratique ordinaire pour accéder à ce qui est évident pour elles (donc rarement expliqué). Objectif : recueillir des raisons d’agir, des normes implicites, des contraintes.",
      example:"Médiathèque : “Pourquoi venir ici plutôt qu’en ligne ?”, “Qu’est-ce qui vous gêne ?”, “À quel moment c’est le mieux ?”.",
      goals:"Multiplier les perspectives ; apprendre les questions ouvertes ; produire une synthèse thématique.",
      attention:"Consentement ; anonymisation ; pas de pression en cas de refus ; éviter questions intrusives.",
      protocol:{
        roles:[
          "Enquêteur·se : pose les questions, relance, garde un ton neutre.",
          "Scribe : note des mots exacts + exemples (verbatim courts).",
          "Chronométreur·se : 5 minutes max par entretien.",
          "Si seul·e : privilégie la prise de notes plutôt que l’enregistrement."
        ],
        observe:[
          "Ce que la personne fait (pratiques) et pourquoi (raisons).",
          "Ce qui compte (critères) : confort, vitesse, sécurité, prix, habitudes.",
          "Ce qui gêne (problèmes) et les “règles implicites” (ce qu’on ne fait pas).",
          "Vocabulaire/expressions typiques."
        ],
        steps:[
          "Préparer 4 questions ouvertes + 1 question de relance (“peux-tu donner un exemple ?”).",
          "Approcher poliment : se présenter + demander l’accord + annoncer la durée.",
          "Conduire l’entretien : 80% écoute, 20% relances.",
          "Noter 1–2 citations courtes + un exemple concret.",
          "Après : classer en 3–5 thèmes (ex. confort / contraintes / astuces).",
          "Synthèse : 5 idées + 3 citations (anonymisées)."
        ],
        material:[
          "Fiche questions ; carnet ; stylo.",
          "Option : enregistrement audio (avec accord explicite)."
        ],
        outputs:[
          "Notes d’entretiens + 3–5 thèmes.",
          "3 citations courtes anonymisées.",
          "Une synthèse d’une dizaine de lignes."
        ]
      },
      kv:{
        Qui:"Enquêteur·se + 2–5 personnes volontaires.",
        Quoi:"Raisons, critères, problèmes, règles implicites, vocabulaire.",
        Comment:"Questions ouvertes + relances + synthèse thématique.",
        Combien:"2–5 entretiens de 3–7 min.",
        Quand:"Sur place, moment ordinaire.",
        Où:"Lieu lié à la pratique (sans gêner).",
        Pourquoi:"Accéder au sens que les acteurs donnent à leurs actions.",
        PourQuoi:"Synthèse thématique réutilisable en cours/dossier."
      },
      variants:"Variante : comparer habitué·e vs nouveau/elle venu·e.",
      tags:["entretien","questions ouvertes","verbatim","anonymat"]
    },

    {
      id:6, title:"Diagramme de situation (qui fait quoi)", cat:"obs", icon:"diagram",
      desc:"Observer une scène et représenter les rôles et interactions (qui initie, qui répond, qui contrôle, qui aide). Objectif : rendre visible l’organisation sociale en action.",
      example:"Buvette : serveur→client→caisse ; file ; ajustements ; “règles” d’ordre et d’espace.",
      goals:"Clarifier rôles/hiérarchies/coordination ; structurer une observation complexe.",
      attention:"Ne pas prêter d’intentions : décrire actions/paroles ; anonymiser.",
      protocol:{
        roles:[
          "Repéreur·se : liste les acteurs/rôles (serveur, client, surveillant…).",
          "Traceur·se : dessine le diagramme (nœuds + flèches).",
          "Observateur·rice de séquences : note 2–3 séquences typiques (début/plein/fin)."
        ],
        observe:[
          "Acteurs + rôles (formels/informels).",
          "Actions : demander, répondre, contrôler, aider, attendre, orienter.",
          "Objets médiateurs : caisse, ticket, panneau, barrière, smartphone.",
          "Séquences : étapes répétées (ex. commander→payer→recevoir)."
        ],
        steps:[
          "Choisir une scène (10–15 min) et un angle de vue stable.",
          "Lister acteurs/rôles (anonymes) + objets clés.",
          "Noter une séquence complète (du début à la fin).",
          "Dessiner le diagramme : acteurs = nœuds ; actions = flèches légendées.",
          "Ajouter 3 notes : où ça bloque ? où ça accélère ? qui régule ?",
          "Mise au propre : diagramme clair + 6 lignes d’explication."
        ],
        material:[
          "Feuille + stylo ; éventuellement post-its pour déplacer les acteurs.",
          "Minuteur."
        ],
        outputs:[
          "Diagramme final (lisible, légendé).",
          "2–3 séquences typiques décrites.",
          "3 constats sur la coordination (sans juger)."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s) ; acteurs anonymes.",
        Quoi:"Rôles, actions, séquences, objets médiateurs.",
        Comment:"Liste + diagramme + légende + mini-synthèse.",
        Combien:"30–40 min.",
        Quand:"Situation routinière.",
        Où:"Lieu où l’action est visible (sans gêner).",
        Pourquoi:"Comprendre comment une activité tient collectivement.",
        PourQuoi:"Diagramme pour analyse/restitution."
      },
      variants:"Variante : comparer “début” vs “heure de pointe”.",
      tags:["diagramme","rôles","séquences","coordination"]
    },

    {
      id:7, title:"Micro-événements (chronologie)", cat:"obs", icon:"list",
      desc:"Pendant 20 minutes, noter tout ce qui change (arrivées, repositionnements, interruptions). Objectif : construire une chronologie et repérer des déclencheurs (ce qui fait bouger la situation).",
      example:"Hall : groupe arrive→bruit augmente→d’autres s’éloignent→un adulte intervient→retour au calme.",
      goals:"Voir le changement ; apprendre l’horodatage ; décrire sans psychologiser.",
      attention:"Rester descriptif : “se lève, se rapproche, parle fort” plutôt que “il s’énerve”.",
      protocol:{
        roles:[
          "Chroniqueur·se : note les événements avec heure/minute approximative.",
          "Observateur·rice spatial : note où ça se passe (zone A/B/C).",
          "Si seul·e : codes rapides (A/B/C + flèches) pour gagner du temps."
        ],
        observe:[
          "Arrivées/départs ; changements de posture ; regroupements/dispersion.",
          "Déclencheurs possibles : un objet, une personne, un signal sonore, une règle.",
          "Intensité : calme/moyen/fort ; vitesse des changements.",
          "Interactions : qui initie ? qui suit ? qui évite ?"
        ],
        steps:[
          "Découper l’espace en 3 zones (A/B/C) sur un mini-plan.",
          "Lancer le minuteur (20 min).",
          "Noter chaque changement : [heure] + [zone] + [fait].",
          "À la fin : relire et surligner 5 événements clés.",
          "Construire une frise chronologique (avec flèches).",
          "Formuler 2–3 hypothèses prudentes de déclencheurs + limites."
        ],
        material:[
          "Carnet ; stylo ; minuteur.",
          "Option : plan du lieu (imprimé) pour annoter."
        ],
        outputs:[
          "Liste horodatée d’événements.",
          "Frise chronologique.",
          "5 événements clés + hypothèses prudentes."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s).",
        Quoi:"Changements/événements, séquences, déclencheurs.",
        Comment:"Notes horodatées + frise + synthèse.",
        Combien:"20 min + 15 min.",
        Quand:"Moment ordinaire ; option comparaison 2 moments.",
        Où:"Lieu où il se passe “quelque chose”.",
        Pourquoi:"Saisir l’action en train de se faire.",
        PourQuoi:"Chronologie utilisable pour expliquer une dynamique."
      },
      variants:"Variante : ne noter que “déplacements” ou que “prises de parole”.",
      tags:["chronologie","micro-événements","déclencheurs"]
    },

    {
      id:8, title:"Comparaison de points de vue", cat:"inter", icon:"compare",
      desc:"Comparer 2 à 4 points de vue sur un même lieu/objet (habitué, novice, riverain, usager). Objectif : faire émerger divergences d’attention et conflits d’interprétation.",
      example:"Skatepark : skateurs vs riverains vs commune vs novices.",
      goals:"Trianguler ; comprendre intérêts/contraintes ; cartographier convergences/divergences.",
      attention:"Neutralité ; reformuler fidèlement ; anonymiser ; ne pas “trancher” pendant la collecte.",
      protocol:{
        roles:[
          "Enquêteur·se : même questions pour tous (comparabilité).",
          "Scribe : note réponses + exemples concrets.",
          "Synthétiseur·se : construit le tableau comparatif."
        ],
        observe:[
          "Ce que chacun·e remarque en premier.",
          "Ce qui compte (critères) : sécurité, confort, bruit, esthétique, règles.",
          "Ce qui gêne + solutions proposées.",
          "Mots/expressions qui reviennent."
        ],
        steps:[
          "Définir 4 questions identiques (ex. “Qu’est-ce qui marche bien ? / gêne ? / règle implicite ? / amélioration ?”).",
          "Interviewer 2–4 profils contrastés (5–10 min).",
          "Remplir le tableau : profil / ce qui compte / ce qui gêne / solution.",
          "Surligner convergences (accord) et divergences (désaccord).",
          "Produire une mini-carte : où se situent les tensions (zones/problèmes).",
          "Synthèse : 5 lignes + 3 exemples concrets."
        ],
        material:[
          "Fiche questions ; tableau (papier ou Excel/Sheets)."
        ],
        outputs:[
          "Tableau comparatif.",
          "Liste convergences/divergences.",
          "Carte des désaccords (option)."
        ]
      },
      kv:{
        Qui:"Enquêteur·se + 2–4 profils.",
        Quoi:"Perceptions, critères, problèmes, solutions.",
        Comment:"Questions identiques + tableau comparatif.",
        Combien:"30–60 min.",
        Quand:"Sur place ou juste après l’expérience.",
        Où:"Lieu concerné ou endroit calme.",
        Pourquoi:"Comprendre la pluralité des regards.",
        PourQuoi:"Synthèse comparative utile pour débat/diagnostic."
      },
      variants:"Variante : ajouter un 5e profil “expert” (agent communal, pro…).",
      tags:["comparaison","points de vue","triangulation","désaccords"]
    },

    {
      id:9, title:"Veille / observation à distance", cat:"suivi", icon:"screen",
      desc:"Observer un sujet via des sources (presse, rapports, réseaux, statistiques). Objectif : repérer cadrages, angles morts, contradictions et évolutions dans le temps.",
      example:"Quartier : articles locaux + stats communales + posts + plans d’aménagement + photos anciennes.",
      goals:"Apprendre la veille ; comparer les cadrages ; construire un dossier annoté.",
      attention:"Toujours noter source + date ; distinguer info/opinion/pub ; résumer plutôt que copier-coller.",
      protocol:{
        roles:[
          "Veilleur·se : collecte régulièrement (rythme fixe).",
          "Archiviste : fiche chaque item (source/date/angle).",
          "Analyste : repère thèmes dominants + angles morts."
        ],
        observe:[
          "Angles : ce que la source met en avant (sécurité, économie, émotion, chiffres…).",
          "Acteurs cités/absents ; vocabulaire ; images dominantes.",
          "Contradictions entre sources ; évolutions temporelles."
        ],
        steps:[
          "Définir un thème + 6–10 sources (au moins 2 officielles).",
          "Mettre un rythme (2 fois/semaine).",
          "Fiche par item : résumé 3 lignes + citation courte + mots-clés + angle.",
          "Chaque semaine : classer en 3–5 thèmes.",
          "À mi-parcours : repérer “angles morts” (ce qui manque).",
          "Final : synthèse (tendances + contradictions) + mini-bibliographie."
        ],
        material:[
          "Dossier (Drive/OneNote) ; tableau de suivi ; outil de capture (liens)."
        ],
        outputs:[
          "Dossier annoté (items).",
          "Synthèse thématique.",
          "Timeline (option) + carte des acteurs (option)."
        ]
      },
      kv:{
        Qui:"Veilleur·se / chercheur·se.",
        Quoi:"Infos + cadrages + acteurs + évolutions.",
        Comment:"Collecte régulière + fiches + synthèses.",
        Combien:"2–8 semaines (selon projet).",
        Quand:"Rythme fixe (lundi/jeudi).",
        Où:"En ligne + bibliothèque.",
        Pourquoi:"Observer indirectement et comparer les récits.",
        PourQuoi:"Dossier exploitable pour cours, TM, exposition."
      },
      variants:"Variante : “focus images” (analyser seulement les photos/visuels).",
      tags:["veille","sources","cadrage","timeline"]
    },

    {
      id:10, title:"Objectif focalisé (une seule question)", cat:"obs", icon:"target",
      desc:"Choisir une question observable unique et s’y tenir. Objectif : augmenter la précision et réduire le “bruit” (tout noter).",
      example:"Cantine : “Où se forment les files informelles ?” (zones + déclencheurs).",
      goals:"Travailler l’indicateur ; produire une donnée claire ; apprendre à cadrer.",
      attention:"Ne pas élargir en cours : si tu changes, note le changement et recommence.",
      protocol:{
        roles:[
          "Formulateur·rice : transforme l’intérêt en question observable.",
          "Compteur·se : relève 2–3 indicateurs (nombre, durée, zone).",
          "Cartographe : note sur plan où ça se produit."
        ],
        observe:[
          "Indicateurs simples : nombre, durée, distance, zone, direction.",
          "Événements liés : déclencheurs (signal, arrivée d’un objet/personne).",
          "Exceptions : cas qui ne rentrent pas dans la règle."
        ],
        steps:[
          "Formuler 1 question + 2–3 indicateurs mesurables.",
          "Définir la zone + le point d’observation.",
          "Observer 15–20 min en notant seulement les indicateurs.",
          "Faire un mini-plan annoté (zones/points chauds).",
          "Répondre : “ce que j’ai vu” + “ce que je n’ai pas pu voir”.",
          "Proposer une amélioration du protocole (si je recommence…)."
        ],
        material:[
          "Plan (même approximatif), carnet, stylo, minuteur."
        ],
        outputs:[
          "Réponse argumentée à la question.",
          "Données (compte, durées, zones) + plan annoté.",
          "Limites + piste de suite."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s).",
        Quoi:"Un seul phénomène défini + indicateurs.",
        Comment:"Observation focalisée + relevés + plan.",
        Combien:"25–35 min.",
        Quand:"Moment où le phénomène a lieu.",
        Où:"Zone ciblée.",
        Pourquoi:"Gagner en précision.",
        PourQuoi:"Donnée claire pour analyse/argumentation."
      },
      variants:"Variante : refaire le lendemain (comparaison).",
      tags:["cadrage","indicateurs","précision","question"]
    },

    {
      id:11, title:"Observation participante", cat:"imm", icon:"hands",
      desc:"Participer à une activité (avec accord) et observer “de l’intérieur” : rôles, règles implicites, vocabulaire, coordination, manières de faire. Objectif : accéder à des dimensions invisibles depuis l’extérieur.",
      example:"Repair café : aider à l’accueil, observer comment on demande de l’aide, comment on valide une réparation, les “astuces” partagées.",
      goals:"Comprendre par l’expérience ; repérer non-dits ; documenter une pratique et ses règles implicites.",
      attention:"Consentement clair ; pas d’espionnage ; pas de photos/sons sans accord ; prendre du recul après (effet d’immersion).",
      protocol:{
        roles:[
          "Participant-observateur·rice : tu aides réellement (rôle concret).",
          "Scribe (après coup) : tu écris un compte rendu structuré.",
          "Si groupe : un·e participe, un·e observe plus à distance, puis vous comparez."
        ],
        observe:[
          "Rôles : qui sait quoi ? qui décide ? qui accueille ? qui explique ?",
          "Règles implicites : ce qu’on fait / ne fait pas ; ce qui est valorisé.",
          "Vocabulaire et “petits signes” (humour, gestes, routines).",
          "Objets/espaces : outils, zones, parcours dans le lieu."
        ],
        steps:[
          "Demander l’accord + expliquer l’objectif + définir ce que tu feras (aide).",
          "Participer (1h30–3h) en notant mentalement mots-clés.",
          "À chaud (5 min) : écrire une liste brute (faits marquants).",
          "Au calme (20–30 min) : rédiger en 3 parties : organisation / scènes / règles implicites.",
          "Faire un schéma des rôles (qui fait quoi, avec flèches).",
          "Synthèse : 5 règles implicites + 3 surprises + 2 questions à vérifier."
        ],
        material:[
          "Carnet (notes surtout après), stylo.",
          "Option : plan du lieu (croquis), uniquement sans données sensibles."
        ],
        outputs:[
          "Récit structuré (1 page).",
          "Schéma des rôles.",
          "Liste : règles implicites + surprises + questions."
        ]
      },
      kv:{
        Qui:"Participant-observateur·rice + membres (anonymisés).",
        Quoi:"Organisation, règles implicites, vocabulaire, objets/espaces.",
        Comment:"Participation réelle + écriture après coup + schéma.",
        Combien:"1 séance (1h30–3h) + 30 min de rédaction.",
        Quand:"Moment de pratique réelle.",
        Où:"Dans le lieu de l’activité.",
        Pourquoi:"Accéder à l’intérieur d’une pratique.",
        PourQuoi:"Compte rendu riche + schéma pour restitution."
      },
      variants:"Variante : 2 séances pour voir ce qui change (nouveauté vs routine).",
      tags:["immersion","règles implicites","pratique","rôles"]
    },

    {
      id:12, title:"Parcours commentés", cat:"parc", icon:"walk",
      desc:"Se faire guider par un·e usager·ère d’un lieu, qui commente en marchant (repères, ambiances, souvenirs, dangers, plaisirs). Objectif : comprendre l’espace vécu et les critères de navigation.",
      example:"Tour du quartier : coins évités, raccourcis, lieux “cool”, sons/odeurs, espaces de socialisation.",
      goals:"Accéder à des repères ordinaires ; comprendre les critères d’un trajet ; comparer des parcours pour analyser contraintes et attachements.",
      attention:"Consentement (audio) ; sécurité du trajet ; anonymiser lieux sensibles ; ne pas forcer des confidences.",
      protocol:{
        roles:[
          "Guide (participant) : choisit l’itinéraire et commente librement.",
          "Accompagnateur·rice : pose des questions naïves courtes (peu).",
          "Cartographe : dessine le trajet + repères (si groupe)."
        ],
        observe:[
          "Repères : ce qui sert à se situer (bâtiments, sons, odeurs).",
          "Critères : sécurité, efficacité, esthétique, sociabilité, confort.",
          "Règles : ce qu’on évite, ce qu’on préfère, où on ralentit/accélère.",
          "Ambiances : zones calmes/bruyantes, agréables/désagréables."
        ],
        steps:[
          "Brief : “tu me guides comme tu veux pendant 20–30 min”.",
          "Marche : le guide parle ; l’accompagnateur relance doucement.",
          "Notes rapides : mots-clés + repères + moments de bascule (“ici je change”).",
          "Fin : débrief 10 min (3 lieux clés + pourquoi).",
          "Le guide annote un plan/croquis (trajet + repères + émotions).",
          "Synthèse : 5 repères + 3 critères dominants du guide."
        ],
        material:[
          "Carnet ; plan simple (option) ; enregistreur avec accord."
        ],
        outputs:[
          "Plan commenté (trajet + repères).",
          "Synthèse des critères du guide.",
          "Comparaison possible entre 2 guides."
        ]
      },
      kv:{
        Qui:"Guide + accompagnateur·rice.",
        Quoi:"Repères, critères, ambiances, choix de trajet.",
        Comment:"Marche commentée + plan annoté + synthèse.",
        Combien:"30–45 min.",
        Quand:"Moment où le lieu est “parlant” (ou comparatif).",
        Où:"Itinéraire du guide.",
        Pourquoi:"Comprendre l’espace vécu.",
        PourQuoi:"Plan commenté utile pour analyse/restitution."
      },
      variants:"Variante : 2 guides (habitant vs visiteur) → comparaison.",
      tags:["parcours","repères","critères","espace vécu"]
    },

    {
      id:13, title:"Perturbation volontaire", cat:"exp", icon:"warning",
      desc:"Observer une situation normée, puis faire une transgression douce et réversible pour révéler les normes implicites et les mécanismes de régulation.",
      example:"Ascenseur : te placer dos aux portes ; file : te mettre trop près (sans toucher), puis reculer ; observer ajustements et remarques.",
      goals:"Rendre visibles les normes ; analyser sanctions/ajustements ; comprendre la “réparation” de l’ordre social.",
      attention:"Perturbation légère ; stop si malaise ; éviter publics vulnérables ; pas de moquerie ; pas de film.",
      protocol:{
        roles:[
          "Acteur-expérimentateur·rice : réalise la perturbation (douce).",
          "Observateur·rice : note les réactions (regards, distances, paroles).",
          "Chronométreur·se : durée courte (10–20 s) + pauses."
        ],
        observe:[
          "Norme initiale : distances, positions, ordre, regard.",
          "Réactions : évitement, humour, rappel à l’ordre, repositionnement.",
          "Régulateurs : qui intervient ? comment ? (parole, geste, silence).",
          "Après-coup : retour à la routine (vitesse de réparation)."
        ],
        steps:[
          "Phase 1 (5 min) : observer la routine “normale” et la décrire.",
          "Définir une perturbation micro (non agressive, réversible).",
          "Phase 2 : effectuer la perturbation 10–20 secondes.",
          "Noter immédiatement les réactions (factuel) + intensité.",
          "Pause 1–3 min, puis répéter 2–5 fois max.",
          "Mise au propre : tableau “routine vs perturbation” + typologie des réactions."
        ],
        material:[
          "Carnet + stylo ; minuteur."
        ],
        outputs:[
          "Tableau routine/perturbation.",
          "Typologie de réactions (4–6 catégories).",
          "Mini-analyse (ce que cela dit des normes)."
        ]
      },
      kv:{
        Qui:"Acteur-expérimentateur·rice + observateur·rice(s).",
        Quoi:"Normes implicites + réactions + réparation.",
        Comment:"Observer routine → micro-perturbation → relever réactions.",
        Combien:"20–40 min.",
        Quand:"Moment ordinaire (pas tendu).",
        Où:"Lieu public simple, sans risque.",
        Pourquoi:"La norme se voit quand elle est transgressée.",
        PourQuoi:"Comprendre règles implicites et régulation."
      },
      variants:"Variante : comparer deux lieux (école vs gare).",
      tags:["normes","transgression douce","régulation","interaction"]
    },

    {
      id:14, title:"Suivi de zone", cat:"suivi", icon:"clock",
      desc:"Revenir régulièrement dans une zone définie pour documenter son évolution (série de notes/photos/sons). Objectif : repérer rythmes, cycles, événements et facteurs explicatifs.",
      example:"Carré de parc : photo fixe 3×/semaine ; noter lumière, feuilles, déchets, passage de chiens ; livret final.",
      goals:"Observer au temps long ; comparer ; produire une restitution sérielle (fanzine, poster, timeline).",
      attention:"Même cadrage ; noter contexte (heure/météo) ; ne pas perturber le lieu ; attention au droit à l’image.",
      protocol:{
        roles:[
          "Photographe fixe : reprend le même cadrage (repère au sol).",
          "Noteur·se : fiche contexte + 3 observations + 1 surprise.",
          "Archiviste : classe la série (dates) et prépare la restitution."
        ],
        observe:[
          "Traces : déchets, usure, interventions humaines (nettoyage, travaux).",
          "Vivant : végétation, animaux, saisons.",
          "Ambiances : sons, lumière, température.",
          "Usages : passages, regroupements, micro-rituels."
        ],
        steps:[
          "Délimiter la zone + définir un point photo fixe.",
          "Créer une fiche standard (date/heure/météo + 3 observations + 1 surprise).",
          "Passer 2–3 fois/semaine (ou quotidien) à heure stable.",
          "Comparer chaque semaine : ce qui apparaît/disparaît, ce qui revient.",
          "À la fin : typologie des changements (cycle / événement / intervention).",
          "Restitution : fanzine ou poster (série + commentaires)."
        ],
        material:[
          "Téléphone/appareil photo ; carnet ; fiche standard imprimée."
        ],
        outputs:[
          "Série (photos + fiches).",
          "Typologie des changements + facteurs possibles.",
          "Restitution (fanzine/poster/timeline)."
        ]
      },
      kv:{
        Qui:"Observateur·rice(s).",
        Quoi:"Évolution du lieu (traces, vivant, usages).",
        Comment:"Protocole fixe + série + comparaison.",
        Combien:"2 semaines à 3 mois (selon projet).",
        Quand:"Créneau stable.",
        Où:"Zone délimitée + point photo fixe.",
        Pourquoi:"Comprendre des dynamiques temporelles locales.",
        PourQuoi:"Restitution sérielle (fanzine/timeline)."
      },
      variants:"Variante : “7 distances” (plan large → détail) à chaque passage.",
      tags:["série","temps long","rythmes","typologie"]
    },

    {
      id:15, title:"Compilation thématique", cat:"suivi", icon:"folder",
      desc:"Construire un dossier sur un thème en collectant (sur plusieurs semaines/mois) des extraits variés (textes, images, stats) et en les annotant. Objectif : passer de l’accumulation à la structure (axes, controverses, angles morts).",
      example:"Thème “plastique” : 2 articles/semaine + 1 statistique + 1 exemple local ; tags : santé/tri/industrie/alternatives.",
      goals:"Apprendre la collecte structurée ; repérer cadrages ; préparer une analyse/production (poster, expo, dossier).",
      attention:"Toujours source/date ; résumer ; relecture régulière ; ne pas collecter sans classer.",
      protocol:{
        roles:[
          "Collecteur·rice : collecte selon un rythme.",
          "Tagueur·se : met des mots-clés cohérents.",
          "Synthétiseur·se : écrit des bilans réguliers (hebdo)."
        ],
        observe:[
          "Types de sources (officiel, média, témoin, entreprise).",
          "Mots qui reviennent (champ lexical).",
          "Acteurs cités/absents.",
          "Chiffres-clés et leur origine."
        ],
        steps:[
          "Définir le thème + questions directrices (2–3).",
          "Créer un dossier + une fiche standard par item.",
          "Collecter régulièrement (ex. 2 fois/semaine).",
          "Tagger (3–6 tags) + résumer en 3 lignes.",
          "Chaque semaine : bilan (qu’ai-je appris ? qu’est-ce qui manque ?).",
          "Final : 3 axes + 1 controverse + 1 angle mort."
        ],
        material:[
          "Dossier numérique ; tableur ; outil de prise de notes."
        ],
        outputs:[
          "Dossier annoté.",
          "Synthèse : axes/controverses/angles morts.",
          "Bibliographie/sitographie (courte)."
        ]
      },
      kv:{
        Qui:"Collecteur·rice / veilleur·se.",
        Quoi:"Matériaux variés + cadrages + acteurs + chiffres.",
        Comment:"Collecte → fiches → tags → bilans → synthèse.",
        Combien:"4 semaines à 3 mois.",
        Quand:"Rythme fixe.",
        Où:"En ligne + terrain/local (option).",
        Pourquoi:"Transformer des infos en connaissance structurée.",
        PourQuoi:"Dossier exploitable (cours, TM, expo)."
      },
      variants:"Variante : ajouter une timeline + une carte des acteurs.",
      tags:["dossier","tags","synthèse","controverse"]
    },

    {
      id:16, title:"Inventaire matériel d’une pratique", cat:"inv", icon:"box",
      desc:"Documenter les objets d’une pratique (et leurs gestes) puis construire un diagramme-réseau (objets↔personnes↔lieux↔normes). Objectif : montrer une pratique comme système socio-matériel.",
      example:"Skate : planche, trucks, roues, outils, spots, vidéos, shops, règles de cohabitation.",
      goals:"Voir comment objets/lieux/gestes organisent une culture ; apprendre à relier plutôt qu’aligner.",
      attention:"Demander l’accord pour photos ; ne pas envahir des espaces privés ; anonymiser.",
      protocol:{
        roles:[
          "Inventoriste : liste les objets + leurs variantes (marques, état).",
          "Observateur·rice des gestes : note “comment on s’en sert”.",
          "Cartographe du réseau : fait le diagramme (nœuds + liens)."
        ],
        observe:[
          "Objets : principaux + accessoires + entretien/réparation.",
          "Gestes : routines (préparer, vérifier, partager).",
          "Lieux : où on stocke, où on pratique, où on répare.",
          "Normes : ce qui est valorisé (propre, rapide, bricolé…)."
        ],
        steps:[
          "Choisir la pratique + 2–3 personnes volontaires (si possible).",
          "Faire une liste initiale d’objets (brainstorm).",
          "Sur le terrain : confirmer/compléter (photos/croquis) + noter usages.",
          "Créer une fiche par objet : quoi / à quoi ça sert / qui l’utilise / où.",
          "Construire le réseau : objets↔gestes↔lieux↔acteurs.",
          "Synthèse : 3 liens surprenants + 3 normes implicites."
        ],
        material:[
          "Carnet ; appareil photo (si accord) ; feuille pour diagramme."
        ],
        outputs:[
          "Inventaire illustré.",
          "Diagramme réseau légendé.",
          "Analyse : normes/chaînes d’usage."
        ]
      },
      kv:{
        Qui:"Observateur·rice ; praticien·nes (option).",
        Quoi:"Objets, gestes, lieux, normes.",
        Comment:"Inventaire + fiches + diagramme réseau.",
        Combien:"2–4 sorties sur 2–4 semaines.",
        Quand:"Pendant la pratique réelle.",
        Où:"Lieux de pratique (et entretien si accord).",
        Pourquoi:"Comprendre une pratique par ses objets.",
        PourQuoi:"Système socio-matériel visualisé."
      },
      variants:"Variante : focus “réparation/détournement” (objets modifiés).",
      tags:["inventaire","objets","gestes","réseau","culture"]
    },

    {
      id:17, title:"Collecte idiomatique (lexique d’un domaine)", cat:"lang", icon:"abc",
      desc:"Relever et définir le vocabulaire/jargon d’un domaine peu familier, puis construire un abécédaire accessible à un·e profane. Objectif : comprendre comment le langage structure une pratique.",
      example:"Jeu en ligne : nerf, meta, buff, tilt… → définition simple + exemple de phrase.",
      goals:"Enquête lexicale ; médiation ; compréhension culturelle par les mots.",
      attention:"Vérifier le sens auprès de pratiquants ; noter le contexte d’usage ; ne pas ridiculiser le jargon.",
      protocol:{
        roles:[
          "Collecteur·rice : note les termes inconnus au fil des situations.",
          "Définisseur·se : cherche le sens (sources + validation).",
          "Éditeur·rice : met en forme l’abécédaire (clair, court)."
        ],
        observe:[
          "Mots/expressions, abréviations, anglicismes, métaphores.",
          "Contexte d’usage : qui le dit ? quand ? pour quoi faire ?",
          "Nuances : terme neutre/valorisant/péjoratif."
        ],
        steps:[
          "Choisir un domaine + 2 sources principales (vidéos, forums, terrain).",
          "Lister les termes inconnus (objectif min : 20).",
          "Chercher une définition (2 sources) + vérifier (pratiquant si possible).",
          "Écrire : définition simple + exemple + variante/nuance.",
          "Classer A→Z ; ajouter 5 termes “indispensables”.",
          "Synthèse : que révèle ce lexique sur la culture du domaine ?"
        ],
        material:[
          "Carnet ; accès web ; modèle de fiche terme."
        ],
        outputs:[
          "Abécédaire/lexique.",
          "5 remarques culturelles (ce que les mots montrent)."
        ]
      },
      kv:{
        Qui:"Collecteur·rice + informateurs (option).",
        Quoi:"Jargon/idiomes + sens + contexte.",
        Comment:"Collecte → définition → validation → abécédaire.",
        Combien:"2–4 semaines (min).",
        Quand:"Au fil de la découverte.",
        Où:"En ligne + terrain.",
        Pourquoi:"Accéder à la logique interne d’un groupe.",
        PourQuoi:"Lexique prêt à partager (médiation)."
      },
      variants:"Variante : lexique local (patois) lié à un territoire.",
      tags:["lexique","jargon","abécédaire","culture"]
    },

    {
      id:18, title:"Collecter / classer (typologie)", cat:"inv", icon:"tree",
      desc:"Documenter une chose banale (panneaux, sacs, feuilles…) et construire une classification argumentée (familles + critères + exceptions). Objectif : apprendre la comparaison et la fabrication de catégories.",
      example:"Panneaux d’interdiction : pictos, couleurs, ton, lieux, traductions → familles.",
      goals:"Comparer ; expliciter des critères ; produire une typologie communicable.",
      attention:"Cas hybrides : accepter ; expliciter critères ; droit à l’image si personnes.",
      protocol:{
        roles:[
          "Collecteur·rice : collecte items (photo/dessin + lieu/date).",
          "Codeur·se : remplit un tableau de critères.",
          "Typologue : construit les familles + justifie."
        ],
        observe:[
          "Forme, matière, style, couleurs, texte/picto.",
          "Contexte : où apparaît l’objet ? avec quoi ?",
          "Variations + anomalies (ce qui ne rentre pas)."
        ],
        steps:[
          "Choisir l’objet + définir 5 critères (ex. couleur, texte, lieu…).",
          "Collecter 15–30 items (idéal 50+) avec lieu/date.",
          "Remplir le tableau de critères (une ligne par item).",
          "Regrouper en familles (2–6 familles).",
          "Nommer les familles + décrire la règle.",
          "Faire un poster (arbre/matrice) + ajouter 3 exceptions commentées."
        ],
        material:[
          "Téléphone (photo) ; tableau (papier/Excel) ; feuille A3 pour poster."
        ],
        outputs:[
          "Collection documentée.",
          "Tableau de critères.",
          "Poster de classification + justification."
        ]
      },
      kv:{
        Qui:"Collecteur·rice ; éventuellement binôme.",
        Quoi:"Un type d’objet + ses variations.",
        Comment:"Collecte → critères → familles → poster.",
        Combien:"3–6 semaines (selon ambition).",
        Quand:"Au fil des trajets.",
        Où:"Espace public / quotidien.",
        Pourquoi:"Rendre l’ordinaire comparable.",
        PourQuoi:"Typologie utile pour exposé/affiche."
      },
      variants:"Variante : classification par “usage” plutôt que par “forme”.",
      tags:["classification","typologie","critères","poster"]
    },

    {
      id:19, title:"Composer son protocole portable", cat:"meta", icon:"kit",
      desc:"Construire ton propre protocole réutilisable à partir des techniques précédentes : tu choisis des critères, une méthode de collecte, et une forme de restitution. Objectif : autonomie + éthique (consentement, anonymisation).",
      example:"Visite d’une ville : 1) carte sensible 2) traces 3) 3 mini-entretiens 4) mini-lexique → restitution 1 page + 1 carte + 1 poster.",
      goals:"Adapter la méthode au contexte ; combiner ; expliciter limites ; produire un “kit” personnel.",
      attention:"Vie privée ; droit à l’image ; lieux sensibles ; données personnelles ; pas d’observation intrusive.",
      protocol:{
        roles:[
          "Designer du protocole : décide des questions, indicateurs, durée.",
          "Collecteur·rice : applique la méthode sur le terrain.",
          "Éditeur·rice : met en forme la restitution (claire, courte)."
        ],
        observe:[
          "Ce qui est pertinent pour TON objectif (flux, objets, ambiances, normes…).",
          "Au moins 2 types de données (ex. notes + croquis ; ou entretiens + photos).",
          "Toujours : contexte (où/quand) + limites (ce qui manque)."
        ],
        steps:[
          "Écrire la question centrale + 2 questions secondaires.",
          "Choisir 2–4 techniques (par ex. carte sensible + traces + mini-entretiens).",
          "Fixer la durée (ex. 90 min) + règles éthiques (anonymat).",
          "Collecter sur le terrain (notes factuelles + traces).",
          "Trier (facts / hypothèses / questions).",
          "Restituer (1 page, fanzine, poster, audio) + bilan “si je refais…”."
        ],
        material:[
          "Kit minimal : carnet + stylo + minuteur.",
          "Option : plan, appareil photo (si éthique OK)."
        ],
        outputs:[
          "Fiche protocole (réutilisable).",
          "Restitution (format choisi).",
          "Bilan critique (forces/limites/améliorations)."
        ]
      },
      kv:{
        Qui:"Toi (auteur·rice du protocole).",
        Quoi:"Critères choisis + 2–4 techniques combinées.",
        Comment:"Design → collecte → tri → restitution → bilan.",
        Combien:"1–2h + 30 min (mise au propre).",
        Quand:"Avant/durant/après la sortie.",
        Où:"Territoire visité.",
        Pourquoi:"Autonomie méthodologique.",
        PourQuoi:"Kit personnel réutilisable (et améliorable)."
      },
      variants:"Variante : créer une fiche-template et l’utiliser partout.",
      tags:["protocole","autonomie","éthique","restitution"]
    }
  ];

  /* ⚠️ Il manque encore 12 exercices ? Non : on en a 1–19, MAIS 12–19 sont présents,
     et 2–10 + 11 sont présents. Donc 19 au total OK. */

  /* =========================
     UI
     ========================= */
  const grid = document.getElementById("grid");
  const search = document.getElementById("search");
  const clearBtn = document.getElementById("clearBtn");
  const catMenu = document.getElementById("catMenu");
  const nores = document.getElementById("nores");
  const count = document.getElementById("count");

  let activeCat = "all";

  function renderCatMenu(){
    catMenu.innerHTML = "";
    CATEGORIES.forEach(c=>{
      const btn = document.createElement("button");
      btn.className = "catBtn" + (c.id===activeCat ? " active":"");
      const dot = document.createElement("span");
      dot.className = "catDot";
      dot.style.background = (c.id==="all") ? "rgba(255,255,255,.9)" : `var(${c.dotVar})`;
      btn.appendChild(dot);
      btn.appendChild(document.createTextNode(c.label));
      btn.addEventListener("click", ()=>{
        activeCat = c.id;
        renderCatMenu();
        render();
      });
      catMenu.appendChild(btn);
    });
  }

  function matches(ex, q){
    if(!q) return true;
    const hay = [
      ex.title, ex.desc, ex.example, ex.goals, ex.attention,
      ex.variants,
      (ex.tags||[]).join(" "),
      Object.values(ex.kv||{}).join(" "),
      (ex.protocol?.roles||[]).join(" "),
      (ex.protocol?.observe||[]).join(" "),
      (ex.protocol?.steps||[]).join(" "),
      (ex.protocol?.material||[]).join(" "),
      (ex.protocol?.outputs||[]).join(" "),
    ].join(" ").toLowerCase();
    return hay.includes(q.toLowerCase());
  }

  function render(){
    const q = (search.value || "").trim();
    const filtered = EX.filter(ex=>{
      const catOk = (activeCat==="all" ? true : ex.cat===activeCat);
      const qOk = matches(ex, q);
      return catOk && qOk;
    });

    grid.innerHTML = "";
    filtered.forEach(ex => grid.appendChild(card(ex, q)));

    nores.style.display = filtered.length ? "none" : "block";
    count.style.display = "block";
    count.textContent = `${filtered.length} exercice(s) — Catégorie : ${CATEGORIES.find(c=>c.id===activeCat)?.label || "—"}`;
  }

  function card(ex, q){
    const c = document.createElement("article");
    c.className = "card";
    const badge = catBadge(ex.cat);

    c.innerHTML = `
      <div class="cardHeader">
        <div>
          <div class="exNo">EXERCICE #${ex.id}</div>
          <div class="exTitle">${highlight(ex.title, q)}</div>
        </div>
        <div class="badge" style="background:${badge.bg}">${badge.label}</div>
      </div>

      <div class="iconWrap">${iconSVG(ex.icon)}</div>

      <div class="cardBody">
        <p class="miniDesc">${highlight(ex.desc, q)}</p>
        <div class="actions">
          <button class="btn btnPrimary" data-open="${ex.id}">Ouvrir</button>
          <button class="btn" data-copy="${ex.id}">Copier protocole</button>
        </div>
      </div>
    `;

    c.querySelector("[data-open]")?.addEventListener("click", ()=> openModal(ex.id, q));
    c.querySelector("[data-copy]")?.addEventListener("click", ()=> copyProto(ex.id));

    return c;
  }

  /* =========================
     Modal fill
     ========================= */
  const overlay = document.getElementById("overlay");
  const closeBtn = document.getElementById("closeBtn");

  const mTitle = document.getElementById("mTitle");
  const mMeta  = document.getElementById("mMeta");
  const mDesc  = document.getElementById("mDesc");
  const mExample = document.getElementById("mExample");
  const mGoals = document.getElementById("mGoals");
  const mWarn = document.getElementById("mWarn");
  const mVar = document.getElementById("mVar");
  const mTags = document.getElementById("mTags");
  const mProtocol = document.getElementById("mProtocol");
  const mProtoKV = document.getElementById("mProtoKV");

  function openModal(id, q){
    const ex = EX.find(x=>x.id===id);
    if(!ex) return;

    const badge = catBadge(ex.cat);

    mTitle.innerHTML = `EXERCICE #${ex.id} — ${highlight(ex.title, q)}`;
    mMeta.innerHTML = `Catégorie : <span class="badge" style="background:${badge.bg}; margin-left:.35rem;">${badge.label}</span>`;

    mDesc.innerHTML = highlight(ex.desc, q);
    mExample.innerHTML = highlight(ex.example, q);
    mGoals.innerHTML = highlight(ex.goals, q);

    mWarn.innerHTML = `${warnIcon()}<div><b>Attention :</b> ${highlight(ex.attention, q)}</div>`;

    // Protocole détaillé : sections
    const P = ex.protocol || { roles:[], observe:[], steps:[], material:[], outputs:[] };
    let html = "";
    if(P.roles?.length)   html += sectionHTML("1) Qui fait quoi ?", P.roles, q);
    if(P.observe?.length) html += sectionHTML("2) Quoi observer ?", P.observe, q);
    if(P.steps?.length)   html += sectionHTML("3) Déroulement (comment) ?", P.steps, q);
    if(P.material?.length)html += sectionHTML("4) Matériel / supports", P.material, q);
    if(P.outputs?.length) html += sectionHTML("5) Ce que vous devez produire (traces)", P.outputs, q);
    mProtocol.innerHTML = html || "<div class='block'>—</div>";

    // KV (qui/quoi/comment/combien/quand/où/pourquoi/pour quoi)
    const kvOrder = [
      ["Qui","Qui"],["Quoi","Quoi"],["Comment","Comment"],["Combien","Combien"],
      ["Quand","Quand"],["Où","Où"],["Pourquoi","Pourquoi"],["Pour quoi","PourQuoi"]
    ];
    mProtoKV.innerHTML = "";
    kvOrder.forEach(([label, key])=>{
      const v = ex.kv?.[key] ?? "—";
      const kDiv = document.createElement("div");
      kDiv.className = "k";
      kDiv.textContent = label;
      const vDiv = document.createElement("div");
      vDiv.className = "v";
      vDiv.innerHTML = highlight(String(v), q);
      mProtoKV.appendChild(kDiv);
      mProtoKV.appendChild(vDiv);
    });

    mVar.innerHTML = highlight(ex.variants || "—", q);
    mTags.innerHTML = (ex.tags || []).map(t => `
      <span style="display:inline-block; margin:.2rem .25rem .2rem 0; padding:.25rem .55rem; border:1px solid var(--line); border-radius:999px; background:white; font-weight:950; font-size:.82rem;">
        ${highlight(t, q)}
      </span>`).join("");

    overlay.style.display = "flex";
    document.body.style.overflow = "hidden";
  }

  function closeModal(){
    overlay.style.display = "none";
    document.body.style.overflow = "";
  }
  overlay.addEventListener("click", (e)=>{ if(e.target === overlay) closeModal(); });
  closeBtn.addEventListener("click", closeModal);
  document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeModal(); });

  /* =========================
     Copier protocole (texte)
     ========================= */
  async function copyProto(id){
    const ex = EX.find(x=>x.id===id);
    if(!ex) return;

    const P = ex.protocol || {};
    const kv = ex.kv || {};
    let txt = `EXERCICE #${ex.id} — ${ex.title}\nCatégorie : ${catBadge(ex.cat).label}\n\n`;
    txt += `Précisions : ${ex.desc}\n\n`;
    txt += `Objectifs (pour quoi) : ${ex.goals}\n\n`;
    txt += `Exemple : ${ex.example}\n\n`;
    txt += `PROTOCOLE DÉTAILLÉ\n`;
    if(P.roles?.length){
      txt += `\n1) Qui fait quoi ?\n` + P.roles.map(x=>`- ${x}`).join("\n") + "\n";
    }
    if(P.observe?.length){
      txt += `\n2) Quoi observer ?\n` + P.observe.map(x=>`- ${x}`).join("\n") + "\n";
    }
    if(P.steps?.length){
      txt += `\n3) Déroulement (comment) ?\n` + P.steps.map(x=>`- ${x}`).join("\n") + "\n";
    }
    if(P.material?.length){
      txt += `\n4) Matériel / supports\n` + P.material.map(x=>`- ${x}`).join("\n") + "\n";
    }
    if(P.outputs?.length){
      txt += `\n5) Ce que vous devez produire\n` + P.outputs.map(x=>`- ${x}`).join("\n") + "\n";
    }

    txt += `\nQUI / QUOI / COMMENT / COMBIEN / QUAND / OÙ / POURQUOI / POUR QUOI\n`;
    txt += `Qui : ${kv.Qui || "—"}\n`;
    txt += `Quoi : ${kv.Quoi || "—"}\n`;
    txt += `Comment : ${kv.Comment || "—"}\n`;
    txt += `Combien : ${kv.Combien || "—"}\n`;
    txt += `Quand : ${kv.Quand || "—"}\n`;
    txt += `Où : ${kv.Où || "—"}\n`;
    txt += `Pourquoi : ${kv.Pourquoi || "—"}\n`;
    txt += `Pour quoi : ${kv.PourQuoi || "—"}\n`;

    txt += `\nPoints d’attention : ${ex.attention}\n`;
    txt += `Variantes : ${ex.variants || "—"}\n`;
    txt += `Mots-clés : ${(ex.tags||[]).join(", ")}\n`;

    try{
      await navigator.clipboard.writeText(txt);
      toast("Contenu copié ✅");
    }catch{
      toast("Copie impossible (navigateur).");
    }
  }

  function toast(msg){
    const el = document.createElement("div");
    el.textContent = msg;
    el.style.position = "fixed";
    el.style.left = "50%";
    el.style.bottom = "18px";
    el.style.transform = "translateX(-50%)";
    el.style.background = "#111827";
    el.style.color = "white";
    el.style.padding = ".6rem .85rem";
    el.style.borderRadius = "999px";
    el.style.fontWeight = "950";
    el.style.boxShadow = "0 10px 28px rgba(0,0,0,.25)";
    el.style.zIndex = "200";
    document.body.appendChild(el);
    setTimeout(()=>{ el.style.opacity="0"; el.style.transition="opacity .2s ease"; }, 1200);
    setTimeout(()=>{ el.remove(); }, 1500);
  }

  /* =========================
     Listeners
     ========================= */
  let t = null;
  search.addEventListener("input", ()=>{
    clearTimeout(t);
    t = setTimeout(render, 90);
  });

  clearBtn.addEventListener("click", ()=>{
    search.value = "";
    activeCat = "all";
    renderCatMenu();
    render();
    search.focus();
  });

  /* Init */
  renderCatMenu();
  render();
</script>

<!--
✅ GitHub Pages
1) Crée un dépôt → ajoute un fichier index.html → colle ce code → Commit
2) Settings → Pages → Deploy from branch → main / root
3) Attends que GitHub te donne l’URL du site
-->
</body>
</html>
